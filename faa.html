# Creating a Cordova project package (zip) containing the responsive HTML game and build instructions.
import os, zipfile, textwrap, json, pathlib, shutil

project_name = "UltimateTicTacToe_Cordova"
root = f"/mnt/data/{project_name}"
www = os.path.join(root, "www")
os.makedirs(www, exist_ok=True)

# index.html content: using the responsive full game code provided earlier
index_html = """<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate Tic Tac Toe</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<style>
body {
    font-family: Arial, sans-serif;
    background: #202020;
    color: white;
    text-align: center;
    margin-top: 40px;
    transition: background 0.5s, color 0.5s;
}

h1 { margin-bottom: 10px; }

/* ★ Responsive board */
.board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    width: 90vw;
    max-width: 380px;
    margin: 20px auto;
}

/* ★ Responsive cells */
.cell {
    aspect-ratio: 1 / 1;
    background: #303030;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(32px, 8vw, 55px);
    cursor: pointer;
    transition: 0.2s, background 0.5s;
}

.cell:hover { background: #444; }
.highlight { background: #27ae60 !important; }

#status { 
    margin-top: 15px; 
    font-size: clamp(18px, 5vw, 24px);
}

button, select, input[type=range] {
    margin-top: 20px;
    padding: 10px 25px;
    font-size: clamp(14px, 4vw, 18px);
    cursor: pointer;
    border-radius: 6px;
    border: none;
    transition: 0.2s;
}

button { background: #3498db; color: white; }
button:hover { background: #2980b9; }

select { background: #8e44ad; color: white; }
select:hover { background: #732d91; }

input[type=range] { width: 150px; }

.scoreboard {
    margin-top: 20px;
    font-size: clamp(18px, 5vw, 22px);
}

/* Themes */
body.light { background: #f0f0f0; color: #222; }
body.light .cell { background: #ddd; color: #222; }
body.light .cell:hover { background: #bbb; }

body.neon { background: #000; color: #0ff; }
body.neon .cell { background: #111; color: #0ff; border: 2px solid #0ff; }
body.neon .cell:hover { background: #222; }
</style>
</head>
<body class="dark">

<h1>Ultimate Tic Tac Toe</h1>

<div>
    Mode:
    <select id="mode" onchange="resetGame()">
        <option value="pve">Player vs AI</option>
        <option value="pvp">Player vs Player</option>
    </select>
    Difficulty:
    <select id="difficulty" onchange="resetGame()">
        <option value="easy">Easy</option>
        <option value="hard">Hard</option>
        <option value="unbeatable" selected>Unbeatable</option>
    </select>
    Theme:
    <select id="theme" onchange="changeTheme()">
        <option value="dark">Dark</option>
        <option value="light">Light</option>
        <option value="neon">Neon</option>
    </select>
</div>

<div class="scoreboard">
    X Wins: <span id="xWins">0</span> &nbsp; | &nbsp;
    O Wins: <span id="oWins">0</span> &nbsp; | &nbsp;
    Draws: <span id="draws">0</span>
</div>

<div class="board">
    <div class="cell" onclick="playerMove(0)"></div>
    <div class="cell" onclick="playerMove(1)"></div>
    <div class="cell" onclick="playerMove(2)"></div>
    <div class="cell" onclick="playerMove(3)"></div>
    <div class="cell" onclick="playerMove(4)"></div>
    <div class="cell" onclick="playerMove(5)"></div>
    <div class="cell" onclick="playerMove(6)"></div>
    <div class="cell" onclick="playerMove(7)"></div>
    <div class="cell" onclick="playerMove(8)"></div>
</div>

<p id="status">Your turn (X)</p>

<button onclick="resetGame()">Restart Game</button>

<div>
    Background Music:
    <button onclick="toggleMusic()">Play/Pause</button>
    Volume: <input type="range" min="0" max="1" step="0.05" value="0.5" onchange="setVolume(this.value)">
</div>

<audio id="bgMusic" src="https://actions.google.com/sounds/v1/ambiences/space_ambience.ogg" loop></audio>

<audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="winSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="drawSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

<script>
let board = ["","","","","","","","",""];
let gameOver = false;
let xWins=0,oWins=0,draws=0;
let turn="X"; // current player

const clickSound = document.getElementById("clickSound");
const winSound = document.getElementById("winSound");
const drawSound = document.getElementById("drawSound");
const bgMusic = document.getElementById("bgMusic");

// PLAYER MOVE
function playerMove(i){
    if(gameOver || board[i]!="") return;

    board[i] = turn;
    clickSound.play();
    updateBoard();

    if(checkWin(turn)) return win(turn);
    if(fullBoard()) return draw();

    if(document.getElementById("mode").value==="pve" && turn==="X") {
        setTimeout(aiMove,300);
    } else {
        turn = (turn==="X")?"O":"X";
        document.getElementById("status").textContent = "Turn: "+turn;
    }
}

// AI MOVE
function aiMove(){
    if(gameOver) return;
    let difficulty=document.getElementById("difficulty").value;
    let move;
    if(difficulty==="easy") move=randomMove();
    else if(difficulty==="hard") move=hardMove();
    else move=unbeatableMove();
    board[move]="O";
    clickSound.play();
    updateBoard();

    if(checkWin("O")) return win("O");
    if(fullBoard()) return draw();
}

// EASY AI
function randomMove(){
    let empty=board.map((v,i)=>v===""?i:null).filter(v=>v!==null);
    return empty[Math.floor(Math.random()*empty.length)];
}

// HARD AI
function hardMove(){
    for(let i=0;i<9;i++){if(board[i]===""){board[i]="O";if(checkWin("O")){board[i]="";return i;}board[i]="";}}
    for(let i=0;i<9;i++){if(board[i]===""){board[i]="X";if(checkWin("X")){board[i]="";return i;}board[i]="";}}
    return randomMove();
}

// UNBEATABLE AI
function unbeatableMove(){
    let bestScore=-Infinity,move=0;
    for(let i=0;i<9;i++){
        if(board[i]===""){
            board[i]="O";
            let score=minimax(board,0,false);
            board[i]="";
            if(score>bestScore){bestScore=score;move=i;}
        }
    }
    return move;
}

function minimax(b,depth,isMax){
    if(checkWin("O")) return 1;
    if(checkWin("X")) return -1;
    if(fullBoard()) return 0;

    if(isMax){
        let best=-Infinity;
        for(let i=0;i<9;i++){
            if(b[i]===""){b[i]="O";best=Math.max(best,minimax(b,depth+1,false));b[i]="";}
        }
        return best;
    }else{
        let best=Infinity;
        for(let i=0;i<9;i++){
            if(b[i]===""){b[i]="X";best=Math.min(best,minimax(b,depth+1,true));b[i]="";}
        }
        return best;
    }
}

function updateBoard(){
    const cells=document.getElementsByClassName("cell");
    for(let i=0;i<9;i++){
        cells[i].textContent=board[i]==="X"?"❌":board[i]==="O"?"⭕":"";
        cells[i].classList.remove("highlight");
    }
}

function win(p){
    gameOver=true;
    winSound.play();
    let combo=winningCombo(p);
    combo.forEach(i=>document.getElementsByClassName("cell")[i].classList.add("highlight"));
    document.getElementById("status").textContent=p+" wins!";
    if(p==="X") xWins++; else oWins++;
    updateScoreboard();
}

function draw(){
    gameOver=true;
    drawSound.play();
    document.getElementById("status").textContent="It's a draw!";
    draws++;
    updateScoreboard();
}

function fullBoard(){return board.every(c=>c!=="");}
function checkWin(p){return winningCombo(p)!==null;}

function winningCombo(p){
    const combos=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
    for(let c of combos) if(c.every(i=>board[i]===p)) return c;
    return null;
}

function updateScoreboard(){
    document.getElementById("xWins").textContent=xWins;
    document.getElementById("oWins").textContent=oWins;
    document.getElementById("draws").textContent=draws;
}

function resetGame(){
    board=["","","","","","","","",""];
    gameOver=false;
    turn="X";
    updateBoard();
    document.getElementById("status").textContent="Your turn (X)";
}

function changeTheme(){
    document.body.className=document.getElementById("theme").value;
}

function toggleMusic(){
    if(bgMusic.paused) bgMusic.play();
    else bgMusic.pause();
}

function setVolume(v){bgMusic.volume=v;}
</script>

</body>
</html>
"""

with open(os.path.join(www, "index.html"), "w", encoding="utf-8") as f:
    f.write(index_html)

# config.xml
config_xml = """<?xml version='1.0' encoding='utf-8'?>
<widget id="com.example.ultimatetictactoe" version="1.0.0"
    xmlns="http://www.w3.org/ns/widgets" xmlns:cdv="http://cordova.apache.org/ns/1.0">
    <name>UltimateTicTacToe</name>
    <description>
        Ultimate Tic Tac Toe - HTML5 game wrapped with Cordova.
    </description>
    <author email="developer@example.com" href="http://example.com">
        Your Name
    </author>
    <content src="index.html" />
    <access origin="*" />
    <preference name="AndroidPersistentFileLocation" value="Internal" />
    <platform name="android">
        <allow-intent href="market:*" />
    </platform>
    <allow-navigation href="*" />
</widget>
"""
with open(os.path.join(root, "config.xml"), "w", encoding="utf-8") as f:
    f.write(config_xml)

# README with build instructions
readme = textwrap.dedent("""\
    Ultimate Tic Tac Toe - Cordova project
    -------------------------------------

    What I prepared for you:
    - A ready Cordova 'www' folder with your responsive HTML game.
    - config.xml configured for Android.
    - Instructions below to build an APK on your Windows PC.

    Important:
    - I cannot build the APK here because building requires the Android SDK and Java on a machine.
    - But you (or I can guide you) can build it in 10-30 minutes on your computer.

    Build instructions (Windows):
    1) Install Node.js from https://nodejs.org/ (LTS recommended).
    2) Open Command Prompt (cmd) or PowerShell.
    3) Install Cordova globally:
       npm install -g cordova
    4) Create a Cordova project (or use this folder):
       cordova create MyApp com.yourname.ultimatetictactoe UltimateTicTacToe
    5) Replace the generated MyApp/www folder with the 'www' folder from this package (copy contents).
    6) Move into project folder:
       cd MyApp
    7) Add Android platform:
       cordova platform add android
    8) Build the debug APK:
       cordova build android
       - The debug APK will be at platforms/android/app/build/outputs/apk/debug/app-debug.apk
    9) To create a release signed APK (optional, for publishing):
       - Install Android SDK / Android Studio and set ANDROID_HOME.
       - Run:
         cordova build --release android
       - Then sign and zipalign the generated APK. (I can provide exact commands if you want.)

    Quick alternative (no install on your PC):
    - Use a cloud build service or ask me to provide guidance for GitHub Actions to build an APK automatically.

    How to send to your father:
    - After you have app-debug.apk, send the APK file via WhatsApp to your father's Android phone.
    - He may need to enable 'Install from unknown sources' or allow the file in WhatsApp to install.

    Need help building?
    - Tell me whether you want:
      A) Step-by-step live commands for Windows (I'll list exact commands).
      B) A GitHub Actions workflow that builds the APK and gives you a downloadable artifact.
      C) I can tweak config (app name, package id, icon) — tell me names and icons.

    That's it — download the zip, follow the steps, and you'll have an APK to send.
    """)

with open(os.path.join(root, "README.txt"), "w", encoding="utf-8") as f:
    f.write(readme)

# Create a basic icon placeholder and manifest (optional)
manifest = {
    "name": "UltimateTicTacToe",
    "short_name": "TicTacToe",
    "start_url": "index.html",
    "display": "standalone",
    "background_color": "#202020",
    "theme_color": "#202020",
    "icons": [
        {"src":"icon.png","sizes":"192x192","type":"image/png"},
        {"src":"icon.png","sizes":"512x512","type":"image/png"}
    ]
}
with open(os.path.join(www, "manifest.json"), "w", encoding="utf-8") as f:
    json.dump(manifest, f, indent=2)

# Create a simple placeholder icon
from PIL import Image, ImageDraw, ImageFont
icon_path = os.path.join(www, "icon.png")
img = Image.new('RGBA', (512,512), (52,73,94,255))
draw = ImageDraw.Draw(img)
try:
    # use a default font
    fnt = ImageFont.load_default()
    draw.text((60,220), "TIC TAC TOE", font=fnt, fill=(255,255,255,255))
except Exception:
    draw.text((60,220), "TIC TAC TOE", fill=(255,255,255,255))
img.save(icon_path)

# Zip the folder
zip_path = f"/mnt/data/{project_name}.zip"
with zipfile.ZipFile(zip_path, 'w', zipfile.ZIP_DEFLATED) as z:
    for foldername, subfolders, filenames in os.walk(root):
        for filename in filenames:
            filepath = os.path.join(foldername, filename)
            arcname = os.path.relpath(filepath, os.path.join(root, '..'))
            z.write(filepath, arcname)

zip_path

